> 后文中使用"条目"表示文件和目录。

系统中存在两种文件：
* 提供给用户管理的文件，只表示文件路径等信息，不包含具体文件内容）。
* 存储用户实际上传数据的文件，存放在目录`sha256_文件大小`下(`sha256`为文件的sha256哈希值)，命名为`当前目录文件数量+1`。

###### 重复数据删除
具有相同数据的文件，只在服务器上保存一份实际数据。

客户端上传文件时，先上传该文件的sha256和文件大小。服务器接受到sha256和文件大小之后，会先查找对应目录是否存在，如果存在，创建其中所有文件的`fileblob`对象的集合，如果不存在，则创建该目录。

接受客户端发送的文件块后，如果当前具有`fileblob`对象，则每当接受到一个文件块后，计算该文件块的sha256，并和所有`fileblob`对象对应的文件块sha256进行比较，将sha256不同的`fileblob`移出集合。当文件传输完成后，如果`fileblob`集合中还存在对象(且最多只能存在一个对象)，则表示这两个对象的数据完全相同，则无需创建新文件。

服务器接受到文件后，还会计算一次sha256，如果和用户上传的sha256不一致，则此次文件上传无效。

###### 条目表
|字段名|数据类型|描述|
|--|--|--|
|id|int|主键，自增|
|parent_id|int|父文件夹id，如果当前是根目录或文件，为 null|
|name|text|名称|
|type|enum('f','d')|类型，文件或目录|
|children_id|text|存放由';'分割的子文件id，可以为null|
|file_path|text|存放具体数据的文件路径，可以为null|
|sha256red_link|text|文件共享后的链接，可以为null|

###### 文件引用表
|字段名|类型|描述|
|--|--|--|
|file_path|text|存放具体数据的文件路径，，主键|
|ref_count|int|被引用的数量，当该数量减少为0时，会将该文件从服务器中删除|

###### 共享链接表
|字段名|类型|描述|
|--|--|--|
|link|text|共享链接|
|file_id|int|文件id|


#### 文件传输
上传文件时，上传端发送文件尺寸，然后两端对文件以4096大小进行分块，下载端每次发送一个下载请求包含一个文件id和文件块索引，上传端口根据该索引返回该请求对应的数据，然后下载端将数据写入文件。为了确保上传下载数据的完整性，使用sha256进行校验。

